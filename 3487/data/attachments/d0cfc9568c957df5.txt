[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [executing] blocked: Insufficient permissions, try: `juju trust untrusted-postgresql-k8s --scope=cluster`
  untrusted-postgresql-k8s/1 [executing] maintenance: installing charm software
  untrusted-postgresql-k8s/2 [executing] maintenance: installing charm software
[1m[31mERROR   [0m asyncio:base_events.py:1821 Task exception was never retrieved
future: <Task finished name='Task-283' coro=<Connection._connect.<locals>._try_endpoint() done, defined at /home/runner/work/postgresql-k8s-operator/postgresql-k8s-operator/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py:727> exception=OSError(9, 'Bad file descriptor')>
Traceback (most recent call last):
  File "/home/runner/work/postgresql-k8s-operator/postgresql-k8s-operator/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py", line 732, in _try_endpoint
    return await self._open(endpoint, cacert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/postgresql-k8s-operator/postgresql-k8s-operator/.tox/integration/lib/python3.12/site-packages/juju/client/connection.py", line 333, in _open
    await websockets.connect(
  File "/home/runner/work/postgresql-k8s-operator/postgresql-k8s-operator/.tox/integration/lib/python3.12/site-packages/websockets/legacy/client.py", line 654, in __await_impl__
    _transport, protocol = await self._create_connection()
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1149, in create_connection
    transport, protocol = await self._create_connection_transport(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1167, in _create_connection_transport
    sock.setblocking(False)
OSError: [Errno 9] Bad file descriptor
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
  untrusted-postgresql-k8s/1 [executing] unknown: 
  untrusted-postgresql-k8s/2 [executing] unknown: 
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [executing] waiting: awaiting for primary endpoint to be ready
  untrusted-postgresql-k8s/1 [idle] unknown: 
  untrusted-postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] active: Primary
  untrusted-postgresql-k8s/1 [idle] unknown: 
  untrusted-postgresql-k8s/2 [idle] unknown: 
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] active: Primary
  untrusted-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
  untrusted-postgresql-k8s/2 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] maintenance: reconfiguring cluster
  untrusted-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
  untrusted-postgresql-k8s/2 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] maintenance: reconfiguring cluster
  untrusted-postgresql-k8s/1 [idle] waiting: awaiting for member to start
  untrusted-postgresql-k8s/2 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] active: Primary
  untrusted-postgresql-k8s/1 [idle] active: 
  untrusted-postgresql-k8s/2 [idle] waiting: awaiting for member to start
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  untrusted-postgresql-k8s/0 [idle] active: Primary
  untrusted-postgresql-k8s/1 [idle] active: 
  untrusted-postgresql-k8s/2 [idle] active:
[32mINFO    [0m pytest_operator.plugin:plugin.py:903 Model status:

Model  Controller          Cloud/Region        Version  SLA          Timestamp
test   microk8s-localhost  microk8s/localhost  3.6.1    unsupported  01:34:08Z

App                       Version  Status  Scale  Charm           Channel  Rev  Address        Exposed  Message
untrusted-postgresql-k8s  14.15    active      3  postgresql-k8s             0  10.152.183.92  no       

Unit                         Workload  Agent  Address       Ports  Message
untrusted-postgresql-k8s/0*  active    idle   10.1.180.139         Primary
untrusted-postgresql-k8s/1   active    idle   10.1.180.141         
untrusted-postgresql-k8s/2   active    idle   10.1.180.140         

[32mINFO    [0m pytest_operator.plugin:plugin.py:909 Juju error logs:

model-123f20b8-96b5-4c86-84ad-87bd459ebf8c: 01:28:21 ERROR juju.kubernetes.klog /build/snapcraft-juju-01fda0e3da354e5022fdf9a425330f77/parts/jujud/build/worker/caasrbacmapper/mapper.go:79: Failed to watch *v1.ServiceAccount: unknown (get serviceaccounts) - error from a previous attempt: read tcp 10.1.180.135:49322->10.152.183.1:443: read: connection reset by peer
unit-untrusted-postgresql-k8s-0: 01:29:57 ERROR unit.untrusted-postgresql-k8s/0.juju-log 
            Access to k8s cluster resources is not authorized. This happens when RBAC is enabled and the deployed application was not trusted by the juju admin.
            To fix this issue, run `juju trust untrusted-postgresql-k8s --scope=cluster` (or remove & re-deploy untrusted-postgresql-k8s with `--trust`)
            
unit-untrusted-postgresql-k8s-0: 01:29:57 ERROR unit.untrusted-postgresql-k8s/0.juju-log 
            Access to k8s cluster resources is not authorized. This happens when RBAC is enabled and the deployed application was not trusted by the juju admin.
            To fix this issue, run `juju trust untrusted-postgresql-k8s --scope=cluster` (or remove & re-deploy untrusted-postgresql-k8s with `--trust`)
            

[32mINFO    [0m pytest_operator.plugin:plugin.py:991 Forgetting model main...