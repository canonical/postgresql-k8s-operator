{"uid":"88046156f2528771","name":"test_tls","fullName":"tests.integration.test_tls#test_tls","historyId":"2261d1bf845985b00a372e1561d88e5e","time":{"start":1748655012175,"stop":1748655706590,"duration":694415},"status":"failed","statusMessage":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-6_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: TResult | None = func()\n                             ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 242, in <lambda>\n    lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/threadexception.py\", line 92, in pytest_runtest_call\n    yield from thread_exception_runtest_hook()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/threadexception.py\", line 68, in thread_exception_runtest_hook\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/unraisableexception.py\", line 95, in pytest_runtest_call\n    yield from unraisable_exception_runtest_hook()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/unraisableexception.py\", line 70, in unraisable_exception_runtest_hook\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/logging.py\", line 846, in pytest_runtest_call\n    yield from self._runtest_for(item, \"call\")\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/logging.py\", line 829, in _runtest_for\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/capture.py\", line 898, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/skipping.py\", line 257, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 174, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1627, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 159, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pytest_asyncio/plugin.py\", line 529, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 164, in test_tls\n    for attempt in Retrying(stop=stop_after_delay(60 * 3), wait=wait_fixed(2), reraise=True):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 445, in __iter__\n    do = self.iter(retry_state=retry_state)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 378, in iter\n    result = action(retry_state)\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 420, in exc_check\n    raise retry_exc.reraise()\n          ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 187, in reraise\n    raise self.last_attempt.result()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    raise self._exception\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 166, in test_tls\n    await check_tls_rewind(ops_test)\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 69, in check_tls_rewind\n    assert \"connection authorized: user=rewind database=postgres SSL enabled\" in logs, (\nAssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-6_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","flaky":true,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"ops_test","time":{"start":1748655003881,"stop":1748655004089,"duration":208},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1748655003881,"stop":1748655003881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop","time":{"start":1748655003881,"stop":1748655003881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1748655012174,"stop":1748655012175,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-6_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: TResult | None = func()\n                             ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 242, in <lambda>\n    lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/threadexception.py\", line 92, in pytest_runtest_call\n    yield from thread_exception_runtest_hook()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/threadexception.py\", line 68, in thread_exception_runtest_hook\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/unraisableexception.py\", line 95, in pytest_runtest_call\n    yield from unraisable_exception_runtest_hook()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/unraisableexception.py\", line 70, in unraisable_exception_runtest_hook\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/logging.py\", line 846, in pytest_runtest_call\n    yield from self._runtest_for(item, \"call\")\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/logging.py\", line 829, in _runtest_for\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/capture.py\", line 898, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    teardown.throw(outcome._exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/skipping.py\", line 257, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 174, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1627, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 513, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 182, in _multicall\n    return outcome.get_result()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 100, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 103, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 159, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pytest_asyncio/plugin.py\", line 529, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 164, in test_tls\n    for attempt in Retrying(stop=stop_after_delay(60 * 3), wait=wait_fixed(2), reraise=True):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 445, in __iter__\n    do = self.iter(retry_state=retry_state)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 378, in iter\n    result = action(retry_state)\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 420, in exc_check\n    raise retry_exc.reraise()\n          ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 187, in reraise\n    raise self.last_attempt.result()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    raise self._exception\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 166, in test_tls\n    await check_tls_rewind(ops_test)\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 69, in check_tls_rewind\n    assert \"connection authorized: user=rewind database=postgres SSL enabled\" in logs, (\nAssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-6_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0132.log:2025-05-31 01:32:08 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-6_0138.log:2025-05-31 01:38:00 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.39,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","steps":[],"attachments":[{"uid":"5f813254d7619a4f","name":"log","source":"5f813254d7619a4f.txt","type":"text/plain","size":20627}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1748655706607,"stop":1748655706607,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1748655706629,"stop":1748655707296,"duration":667},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1748655707297,"stop":1748655707297,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1748655707297,"stop":1748655707297,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1748655707297,"stop":1748655707297,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_tls"},{"name":"host","value":"fv-az1910-19"},{"name":"thread","value":"19779-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_tls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"8c5f1ac0eb1f0ef5","status":"unknown","time":{}}],"categories":[{"name":"Product defects","matchedStatuses":[]}],"history":{"statistic":{"failed":4,"broken":1,"skipped":0,"passed":269,"unknown":6,"total":280},"items":[{"uid":"948d0f72c5e72a56","reportUrl":"../4080//#testresult/948d0f72c5e72a56","status":"passed","time":{"start":1748568590727,"stop":1748569142848,"duration":552121}},{"uid":"8bac92f120c8b100","reportUrl":"../4078//#testresult/8bac92f120c8b100","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-3_0133.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-3_0133.log:2025-05-28 01:33:11 UTC [884]: user=operator,db=postgres,app=[unknown],client=10.1.0.124,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-3_0133.log:2025-05-28 01:33:11 UTC [889]: user=operator,db=postgres,app=[unknown],client=10.1.0.124,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-3_0138.log:2025-05-28 01:38:46 UTC [6532]: user=operator,db=postgres,app=[unknown],client=10.1.0.124,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-3_0138.log:2025-05-28 01:38:46 UTC [6532]: user=operator,db=postgres,app=[unknown],client=10.1.0.124,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1748395873577,"stop":1748396554007,"duration":680430}},{"uid":"48e8cfc130067377","reportUrl":"../4070//#testresult/48e8cfc130067377","status":"passed","time":{"start":1748223036595,"stop":1748223667150,"duration":630555}},{"uid":"bde29b2ee2373779","reportUrl":"../4068//#testresult/bde29b2ee2373779","status":"passed","time":{"start":1748050678255,"stop":1748051233158,"duration":554903}},{"uid":"3faf1037990c2a74","reportUrl":"../4067//#testresult/3faf1037990c2a74","status":"passed","time":{"start":1747963801285,"stop":1747964389354,"duration":588069}},{"uid":"ba68c0845c605673","reportUrl":"../4066//#testresult/ba68c0845c605673","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-4_0134.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-4_0134.log:2025-05-22 01:34:21 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.229,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-4_0134.log:2025-05-22 01:34:21 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.229,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-4_0140.log:2025-05-22 01:40:15 UTC [6559]: user=operator,db=postgres,app=[unknown],client=10.1.0.229,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-4_0140.log:2025-05-22 01:40:15 UTC [6559]: user=operator,db=postgres,app=[unknown],client=10.1.0.229,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1747877541157,"stop":1747878242714,"duration":701557}},{"uid":"b7d4546dd5bd8bb4","reportUrl":"../4065//#testresult/b7d4546dd5bd8bb4","status":"passed","time":{"start":1747791143458,"stop":1747791710406,"duration":566948}},{"uid":"e170c76f90bf51a3","reportUrl":"../4058//#testresult/e170c76f90bf51a3","status":"passed","time":{"start":1747705519315,"stop":1747706064386,"duration":545071}},{"uid":"eaa3846452b28ca7","reportUrl":"../4057//#testresult/eaa3846452b28ca7","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-1_0134.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-1_0134.log:2025-05-19 01:34:10 UTC [884]: user=operator,db=postgres,app=[unknown],client=10.1.0.75,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-1_0134.log:2025-05-19 01:34:10 UTC [889]: user=operator,db=postgres,app=[unknown],client=10.1.0.75,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-1_0140.log:2025-05-19 01:40:04 UTC [6559]: user=operator,db=postgres,app=[unknown],client=10.1.0.75,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-1_0140.log:2025-05-19 01:40:04 UTC [6559]: user=operator,db=postgres,app=[unknown],client=10.1.0.75,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1747618334052,"stop":1747619029652,"duration":695600}},{"uid":"5e49695930a6eef3","reportUrl":"../4056//#testresult/5e49695930a6eef3","status":"passed","time":{"start":1747531836171,"stop":1747532444209,"duration":608038}},{"uid":"c4c1f943300267d6","reportUrl":"../4055//#testresult/c4c1f943300267d6","status":"passed","time":{"start":1747445435232,"stop":1747446020930,"duration":585698}},{"uid":"c8161af8ad009613","reportUrl":"../4054//#testresult/c8161af8ad009613","status":"passed","time":{"start":1747359081386,"stop":1747359617148,"duration":535762}},{"uid":"235dca03bc2dc053","reportUrl":"../4053//#testresult/235dca03bc2dc053","status":"passed","time":{"start":1747272611140,"stop":1747273187327,"duration":576187}},{"uid":"37dbfb659f5a3b98","reportUrl":"../4052//#testresult/37dbfb659f5a3b98","status":"passed","time":{"start":1747186250476,"stop":1747186876545,"duration":626069}},{"uid":"215a93cb7a5f4d5d","reportUrl":"../4047//#testresult/215a93cb7a5f4d5d","status":"passed","time":{"start":1747100197348,"stop":1747100762561,"duration":565213}},{"uid":"8447f93dde319cbe","reportUrl":"../4046//#testresult/8447f93dde319cbe","status":"passed","time":{"start":1747013450413,"stop":1747013992511,"duration":542098}},{"uid":"b391fe7de6bf5e87","reportUrl":"../4045//#testresult/b391fe7de6bf5e87","status":"passed","time":{"start":1746927038645,"stop":1746927609571,"duration":570926}},{"uid":"b264c18404f3dcd7","reportUrl":"../4044//#testresult/b264c18404f3dcd7","status":"passed","time":{"start":1746840587530,"stop":1746841164404,"duration":576874}},{"uid":"268093d906031a23","reportUrl":"../4043//#testresult/268093d906031a23","status":"passed","time":{"start":1746754198187,"stop":1746754730459,"duration":532272}},{"uid":"185e804c6bdf7115","reportUrl":"../4040//#testresult/185e804c6bdf7115","status":"passed","time":{"start":1746668362096,"stop":1746668943807,"duration":581711}}]},"tags":["asyncio","abort_on_fail"]},"source":"88046156f2528771.json","parameterValues":[]}