[32mINFO    [0m juju.model:__init__.py:2301 Deploying ch:amd64/noble/self-signed-certificates-317
[32mINFO    [0m juju.model:__init__.py:2301 Deploying ch:amd64/jammy/glauth-k8s-58
[32mINFO    [0m juju.model:__init__.py:2301 Deploying ch:amd64/jammy/postgresql-k8s-495
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-self-signed-certificates/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-self-signed-certificates/0 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [idle] maintenance: Configuring resources
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [idle] unknown: 
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [executing] maintenance: Configuring resources
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [executing] active: Primary
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [executing] blocked: Backend integration (`pg-database` or `ldap-client`) missing
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [executing] active: Primary
[32mINFO    [0m integration.test_ldap:test_ldap.py:70 Adding relations to GLAuth
[33mWARNING [0m juju.model:__init__.py:1683 relate is deprecated and will be removed. Use integrate instead.
[33mWARNING [0m juju.model:__init__.py:1683 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [idle] blocked: Backend integration (`pg-database` or `ldap-client`) missing
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-postgresql-k8s/0 [idle] active: Primary
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-self-signed-certificates/0 [idle] active: 
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [executing] waiting: Waiting for configuration to be updated
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [executing] waiting: Waiting for configuration to be updated
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [executing] waiting: Waiting for configuration to be updated
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  glauth-k8s/0 [executing] active: 
[32mINFO    [0m integration.test_ldap:test_ldap.py:82 Adding relation to PostgreSQL
[33mWARNING [0m juju.model:__init__.py:1683 relate is deprecated and will be removed. Use integrate instead.
[33mWARNING [0m juju.model:__init__.py:1683 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  postgresql-k8s/0 [idle] active: Primary
[32mINFO    [0m juju.model:__init__.py:3254 Waiting for model:
  postgresql-k8s/0 [executing] active: Primary
[32mINFO    [0m pytest_operator.plugin:plugin.py:951 Model status:

Model    Controller          Cloud/Region        Version  SLA          Timestamp
testing  concierge-microk8s  microk8s/localhost  3.6.14   unsupported  01:39:14Z

App                              Version  Status  Scale  Charm                     Channel      Rev  Address         Exposed  Message
glauth-k8s                                active      1  glauth-k8s                latest/edge   58  10.152.183.203  no       
glauth-postgresql-k8s            14.15    active      1  postgresql-k8s            14/stable    495  10.152.183.24   no       
glauth-self-signed-certificates           active      1  self-signed-certificates  1/stable     317  10.152.183.150  no       
postgresql-k8s                   16.11    active      1  postgresql-k8s                           0  10.152.183.236  no       

Unit                                Workload  Agent  Address       Ports  Message
glauth-k8s/0*                       active    idle   10.1.100.210         
glauth-postgresql-k8s/0*            active    idle   10.1.100.208         Primary
glauth-self-signed-certificates/0*  active    idle   10.1.100.205         
postgresql-k8s/0*                   active    idle   10.1.100.204         Primary

[32mINFO    [0m pytest_operator.plugin:plugin.py:957 Juju error logs:

unit-glauth-self-signed-certificates-0: 01:33:51 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-k8s-0: 01:33:51 ERROR unit.glauth-k8s/0.juju-log Error fetching ConfigMap: configmaps "glauth-k8s" not found
unit-glauth-k8s-0: 01:33:53 ERROR unit.glauth-k8s/0.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/./src/charm.py", line 433, in <module>
    main(GLAuthCharm)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/__init__.py", line 360, in __call__
    return _main.main(charm_class=charm_class, use_juju_for_storage=use_juju_for_storage)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/_main.py", line 507, in main
    manager.run()
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/_main.py", line 491, in run
    self._emit()
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/_main.py", line 426, in _emit
    self._emit_charm_event(self.dispatcher.event_name)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/_main.py", line 470, in _emit_charm_event
    event_to_emit.emit(*args, **kwargs)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/framework.py", line 337, in emit
    framework._emit(event)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/framework.py", line 910, in _emit
    self._reemit(event_path)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/framework.py", line 1028, in _reemit
    custom_handler(event)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/./src/charm.py", line 349, in _on_pebble_ready
    self.__on_pebble_ready(event)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/src/utils.py", line 132, in wrapper
    return func(charm, *args, **kwargs)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/./src/charm.py", line 354, in __on_pebble_ready
    self._certs_integration.update_certificates()
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/src/integrations.py", line 272, in update_certificates
    self._remove_certificates()
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/src/integrations.py", line 319, in _remove_certificates
    self._container.remove_path(file)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/model.py", line 3170, in remove_path
    self._pebble.remove_path(path, recursive=recursive)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/pebble.py", line 2904, in remove_path
    resp = self._request('POST', '/v1/files', None, body)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/pebble.py", line 2182, in _request
    response = self._request_raw(method, path, query, headers, data)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/pebble.py", line 2221, in _request_raw
    response = self.opener.open(request, timeout=self.timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/var/lib/juju/agents/unit-glauth-k8s-0/charm/venv/ops/pebble.py", line 396, in http_open
    return self.do_open(
  File "/usr/lib/python3.10/urllib/request.py", line 1352, in do_open
    r = h.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [Errno 104] Connection reset by peer
unit-glauth-k8s-0: 01:33:54 ERROR juju.worker.uniter pebble poll failed for container "glauth": failed to send pebble-ready event: terminated
unit-glauth-self-signed-certificates-0: 01:34:00 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:34:08 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-postgresql-k8s-0: 01:37:41 ERROR juju.worker.dependency "log-sender" manifold worker returned unexpected error: sending log message: websocket: close 1005 (no status): websocket: close sent
unit-glauth-self-signed-certificates-0: 01:37:46 ERROR juju.worker.dependency "log-sender" manifold worker returned unexpected error: sending log message: websocket: close 1005 (no status): websocket: close sent
unit-glauth-self-signed-certificates-0: 01:37:46 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-postgresql-k8s-0: 01:37:47 ERROR juju.worker.dependency "log-sender" manifold worker returned unexpected error: sending log message: websocket: close 1005 (no status): websocket: close sent
unit-glauth-self-signed-certificates-0: 01:37:54 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:38:05 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:38:15 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:38:27 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:38:38 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:38:46 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:38:54 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'
unit-glauth-self-signed-certificates-0: 01:39:06 ERROR unit.glauth-self-signed-certificates/0.juju-log At least 1 matching relation ID not found with the relation name 'send-ca-cert'

[32mINFO    [0m pytest_operator.plugin:plugin.py:1039 Forgetting model main...