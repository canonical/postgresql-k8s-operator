{"uid":"40f6f9285ee4e4cc","name":"test_tls","fullName":"tests.integration.test_tls#test_tls","historyId":"2261d1bf845985b00a372e1561d88e5e","time":{"start":1752802255908,"stop":1752802943351,"duration":687443},"status":"failed","statusMessage":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-5_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 344, in from_call\n    result: TResult | None = func()\n                             ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 246, in <lambda>\n    lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    raise exception\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/logging.py\", line 850, in pytest_runtest_call\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    raise exc.with_traceback(tb)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/capture.py\", line 900, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/skipping.py\", line 263, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 178, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1671, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    raise exception\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    raise exc.with_traceback(tb)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 157, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pytest_asyncio/plugin.py\", line 529, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 164, in test_tls\n    for attempt in Retrying(stop=stop_after_delay(60 * 3), wait=wait_fixed(2), reraise=True):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 445, in __iter__\n    do = self.iter(retry_state=retry_state)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 378, in iter\n    result = action(retry_state)\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 420, in exc_check\n    raise retry_exc.reraise()\n          ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 187, in reraise\n    raise self.last_attempt.result()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    raise self._exception\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 166, in test_tls\n    await check_tls_rewind(ops_test)\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 69, in check_tls_rewind\n    assert \"connection authorized: user=rewind database=postgres SSL enabled\" in logs, (\nAssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-5_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"event_loop","time":{"start":1752802248730,"stop":1752802248730,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1752802248731,"stop":1752802248959,"duration":228},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1752802248731,"stop":1752802248731,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1752802255907,"stop":1752802255907,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-5_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","statusTrace":"Traceback (most recent call last):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 344, in from_call\n    result: TResult | None = func()\n                             ^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 246, in <lambda>\n    lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    raise exception\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/logging.py\", line 850, in pytest_runtest_call\n    yield\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    raise exc.with_traceback(tb)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/capture.py\", line 900, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/skipping.py\", line 263, in pytest_runtest_call\n    return (yield)\n            ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/runner.py\", line 178, in pytest_runtest_call\n    item.runtest()\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 1671, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    raise exception\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    teardown.throw(exception)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    return result.get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    raise exc.with_traceback(tb)\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    res = yield\n          ^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    res = hook_impl.function(*args)\n          ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/_pytest/python.py\", line 157, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/pytest_asyncio/plugin.py\", line 529, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.12/asyncio/base_events.py\", line 687, in run_until_complete\n    return future.result()\n           ^^^^^^^^^^^^^^^\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 164, in test_tls\n    for attempt in Retrying(stop=stop_after_delay(60 * 3), wait=wait_fixed(2), reraise=True):\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 445, in __iter__\n    do = self.iter(retry_state=retry_state)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 378, in iter\n    result = action(retry_state)\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 420, in exc_check\n    raise retry_exc.reraise()\n          ^^^^^^^^^^^^^^^^^^^\n  File \"/root/spread_project/.tox/integration/lib/python3.12/site-packages/tenacity/__init__.py\", line 187, in reraise\n    raise self.last_attempt.result()\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    return self.__get_result()\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    raise self._exception\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 166, in test_tls\n    await check_tls_rewind(ops_test)\n  File \"/root/spread_project/tests/integration/test_tls.py\", line 69, in check_tls_rewind\n    assert \"connection authorized: user=rewind database=postgres SSL enabled\" in logs, (\nAssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-5_0132.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0132.log:2025-07-18 01:32:52 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-5_0138.log:2025-07-18 01:38:37 UTC [5942]: user=operator,db=postgres,app=[unknown],client=10.1.0.136,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","steps":[],"attachments":[{"uid":"d0e5fbabceb39b9f","name":"log","source":"d0e5fbabceb39b9f.txt","type":"text/plain","size":19895}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1752802943389,"stop":1752802943389,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1752802943415,"stop":1752802944072,"duration":657},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1752802944072,"stop":1752802944073,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1752802944073,"stop":1752802944073,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1752802944073,"stop":1752802944073,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"asyncio"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_tls"},{"name":"host","value":"pkrvmq0rgcvqdmg"},{"name":"thread","value":"19587-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_tls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"73303b3c71b106f3","status":"unknown","time":{}}],"categories":[{"name":"Product defects","matchedStatuses":[]}],"history":{"statistic":{"failed":14,"broken":1,"skipped":0,"passed":306,"unknown":7,"total":328},"items":[{"uid":"210a6ae7f23610ff","reportUrl":"../4282//#testresult/210a6ae7f23610ff","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-4_0139.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-4_0139.log:2025-07-17 01:39:00 UTC [886]: user=operator,db=postgres,app=[unknown],client=10.1.0.151,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-4_0139.log:2025-07-17 01:39:00 UTC [891]: user=operator,db=postgres,app=[unknown],client=10.1.0.151,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-4_0144.log:2025-07-17 01:44:53 UTC [6560]: user=operator,db=postgres,app=[unknown],client=10.1.0.151,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-4_0144.log:2025-07-17 01:44:53 UTC [6560]: user=operator,db=postgres,app=[unknown],client=10.1.0.151,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1752716223993,"stop":1752716919526,"duration":695533}},{"uid":"ff6e0535130a6283","reportUrl":"../4274//#testresult/ff6e0535130a6283","status":"passed","time":{"start":1752629511325,"stop":1752630043977,"duration":532652}},{"uid":"1fb80a10c7b23bdd","reportUrl":"../4262//#testresult/1fb80a10c7b23bdd","status":"passed","time":{"start":1752543118083,"stop":1752543751130,"duration":633047}},{"uid":"7cb0e601bd2a6068","reportUrl":"../4259//#testresult/7cb0e601bd2a6068","status":"passed","time":{"start":1752456700466,"stop":1752457263217,"duration":562751}},{"uid":"4900d6cd6f0fbb76","reportUrl":"../4258//#testresult/4900d6cd6f0fbb76","status":"passed","time":{"start":1752370345621,"stop":1752370913708,"duration":568087}},{"uid":"9e4a9df2f21da5dd","reportUrl":"../4257//#testresult/9e4a9df2f21da5dd","status":"passed","time":{"start":1752283897459,"stop":1752284436918,"duration":539459}},{"uid":"8f4bd140927b2d5a","reportUrl":"../4255//#testresult/8f4bd140927b2d5a","status":"passed","time":{"start":1752197459678,"stop":1752198018714,"duration":559036}},{"uid":"8c20eccfbc234dfd","reportUrl":"../4254//#testresult/8c20eccfbc234dfd","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-4_0134.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-4_0134.log:2025-07-10 01:34:22 UTC [886]: user=operator,db=postgres,app=[unknown],client=10.1.0.115,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-4_0134.log:2025-07-10 01:34:22 UTC [892]: user=operator,db=postgres,app=[unknown],client=10.1.0.115,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-4_0140.log:2025-07-10 01:40:23 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.115,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-4_0140.log:2025-07-10 01:40:23 UTC [6575]: user=operator,db=postgres,app=[unknown],client=10.1.0.115,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1752111144568,"stop":1752111844479,"duration":699911}},{"uid":"f138cfd1a0aa7596","reportUrl":"../4250//#testresult/f138cfd1a0aa7596","status":"passed","time":{"start":1752024731377,"stop":1752025266579,"duration":535202}},{"uid":"c79c1284f079752d","reportUrl":"../4244//#testresult/c79c1284f079752d","status":"passed","time":{"start":1751938294920,"stop":1751938869939,"duration":575019}},{"uid":"5104070bb8261251","reportUrl":"../4241//#testresult/5104070bb8261251","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-1_0133.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-1_0133.log:2025-07-07 01:33:30 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.13,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-1_0133.log:2025-07-07 01:33:30 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.13,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-1_0139.log:2025-07-07 01:39:15 UTC [6551]: user=operator,db=postgres,app=[unknown],client=10.1.0.13,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-1_0139.log:2025-07-07 01:39:15 UTC [6551]: user=operator,db=postgres,app=[unknown],client=10.1.0.13,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1751851894419,"stop":1751852586763,"duration":692344}},{"uid":"8de0c506c9576571","reportUrl":"../4240//#testresult/8de0c506c9576571","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-0_0133.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-0_0133.log:2025-07-06 01:33:18 UTC [883]: user=operator,db=postgres,app=[unknown],client=10.1.0.12,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-0_0133.log:2025-07-06 01:33:18 UTC [888]: user=operator,db=postgres,app=[unknown],client=10.1.0.12,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-0_0139.log:2025-07-06 01:39:01 UTC [6567]: user=operator,db=postgres,app=[unknown],client=10.1.0.12,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-0_0139.log:2025-07-06 01:39:01 UTC [6567]: user=operator,db=postgres,app=[unknown],client=10.1.0.12,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1751765483740,"stop":1751766169455,"duration":685715}},{"uid":"45cce950f1bb3395","reportUrl":"../4239//#testresult/45cce950f1bb3395","status":"passed","time":{"start":1751679020610,"stop":1751679594574,"duration":573964}},{"uid":"3be0ee5bbb1d85d8","reportUrl":"../4238//#testresult/3be0ee5bbb1d85d8","status":"passed","time":{"start":1751592680649,"stop":1751593213044,"duration":532395}},{"uid":"2eae5c6e639893c4","reportUrl":"../4233//#testresult/2eae5c6e639893c4","status":"passed","time":{"start":1751506304821,"stop":1751506828513,"duration":523692}},{"uid":"e87b5e46b697bef9","reportUrl":"../4229//#testresult/e87b5e46b697bef9","status":"unknown","time":{}},{"uid":"b2069efd20e79e46","reportUrl":"../4218//#testresult/b2069efd20e79e46","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-2_0134.log:\\t                  SELECT t.user, STRING_AGG(DISTINCT t.database, \\',\\') AS databases FROM( SELECT u.usename AS user, CASE WHEN u.usesuper THEN \\'all\\' ELSE d.datname END AS database FROM ( SELECT usename, usesuper FROM pg_catalog.pg_user WHERE usename NOT IN (\\'backup\\', \\'monitoring\\', \\'operator\\', \\'postgres\\', \\'replication\\', \\'rewind\\')) AS u JOIN ( SELECT datname FROM pg_catalog.pg_database WHERE NOT datistemplate ) AS d ON has_database_privilege(u.usename, d.datname, \\'CONNECT\\') ) AS t GROUP BY 1;\\n/var/log/postgresql/postgresql-2_0134.log:2025-07-01 01:34:35 UTC [886]: user=operator,db=postgres,app=[unknown],client=10.1.0.149,line=15 LOG:  00000: statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-2_0134.log:2025-07-01 01:34:35 UTC [891]: user=operator,db=postgres,app=[unknown],client=10.1.0.149,line=11 LOG:  00000: statement: GRANT \"internal_access\" TO \"rewind\";\\n/var/log/postgresql/postgresql-2_0140.log:2025-07-01 01:40:48 UTC [6592]: user=operator,db=postgres,app=[unknown],client=10.1.0.149,line=9 LOG:  00000: statement: CREATE TABLE pgrewindtest (testcol INT);\\n/var/log/postgresql/postgresql-2_0140.log:2025-07-01 01:40:48 UTC [6592]: user=operator,db=postgres,app=[unknown],client=10.1.0.149,line=11 LOG:  00000: AUDIT: SESSION,2,1,DDL,CREATE TABLE,TABLE,public.pgrewindtest,CREATE TABLE pgrewindtest (testcol INT);,<not logged>\\n'","time":{"start":1751333557896,"stop":1751334282635,"duration":724739}},{"uid":"d3cbb12b41da8a07","reportUrl":"../4214//#testresult/d3cbb12b41da8a07","status":"passed","time":{"start":1751247096959,"stop":1751247693599,"duration":596640}},{"uid":"512f4dba00729942","reportUrl":"../4213//#testresult/512f4dba00729942","status":"passed","time":{"start":1751160663507,"stop":1751161237425,"duration":573918}},{"uid":"b891b8eddb2073ce","reportUrl":"../4212//#testresult/b891b8eddb2073ce","status":"passed","time":{"start":1751074266715,"stop":1751074810738,"duration":544023}}]},"tags":["asyncio","abort_on_fail"]},"source":"40f6f9285ee4e4cc.json","parameterValues":[]}